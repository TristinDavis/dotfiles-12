#!/usr/bin/env sh
# Disable unused services.

csrutil status | grep -q enabled
sip_on=$?

if [ $sip_on -eq 0 ]; then
    printf 'SIP is enabled.

1.  Restart your Mac and hold Command+R as it boots.
2.  Utilities -> Terminal.
3.  `csrutil disable`.
4.  Reboot.
5.  Do your thing. (Renable SIP afterward.)

'
else
    printf 'Disabling unused services. Expect a password prompt.\n' 1>&2

    # Disable Notification Center.
    sudo launchctl unload -w /System/Library/LaunchAgents/com.apple.notificationcenterui.plist

    # Disable Spotlight.
    sudo launchctl unload -w /System/Library/LaunchDaemons/com.apple.metadata.mds.plist

    # Disable Time Machine.
    sudo tmutil disable
fi
